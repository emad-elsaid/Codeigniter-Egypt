<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    
    <title>dojo.dnd package &mdash; Dojo Toolkit v1.3.0 documentation</title>
    <link rel="stylesheet" href="../_static/default.css" type="text/css" />
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../',
        VERSION:     '1.3.0',
        COLLAPSE_MODINDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true
      };
    </script>
    <script type="text/javascript" src="../_static/jquery.js"></script>
    <script type="text/javascript" src="../_static/doctools.js"></script>
    <link rel="author" title="About these documents" href="../about.html" />
    <link rel="top" title="Dojo Toolkit v1.3.0 documentation" href="../index.html" />
    <link rel="up" title="Dojo" href="contents.html" />
    <link rel="next" title="dojo.dnd.Moveable" href="dnd/Moveable.html" />
    <link rel="prev" title="dojo.disconnect" href="disconnect.html" />
<script type="text/javascript">
	var djConfig = {
		parseOnLoad:true, 
		isDebug: false
	}
</script>
<script type="text/javascript" src="../_static/dojo/dojo/dojo.js"></script>
<style type="text/css">
@import "../_static/dojo/dijit/themes/dijit.css";
@import "../_static/dojo/dijit/themes/nihilo/nihilo.css";
@import "../_static/dojo/docs/widget/resources/CodeViewer.css";
@import "../_static/css/layout.css";
</style>

  </head>
  <body>  

    <div class="document">
	<div id="container">
      <div id="header">
	<div class="container">
		<div id="navHeader">
		  <ul>
		    <li><a href="../index.html">home</a> |</li>
            <li style="margin-right: 10px">
		      <a href="dnd/Moveable.html" title="dojo.dnd.Moveable"
			 accesskey="N">next</a></li>
            <li >
		      <a href="disconnect.html" title="dojo.disconnect"
			 accesskey="P">previous</a> |</li>
		    <li><a href="../contents.html">Dojo Toolkit v1.3.0 documentation</a> &raquo;</li>
		      <li><a href="contents.html" accesskey="U">Dojo</a> &raquo;</li> 
		  </ul>
		</div>
		<div id="searchHeader">
		    <div class="searchContainer">
		        <form class="search" action="../search.html" method="get">
                    <input class="textInput" type="text" name="q" size="18" />
                    <input class="buttonInput" type="submit" value="Go" />
                    <input type="hidden" name="check_keywords" value="yes" />
                    <input type="hidden" name="area" value="default" />
                </form>
		    </div>
		</div>
	</div>
      </div>
      <div class="content">
	<div id="content">
		  <div id="contentRight">
			  
      <div class="sphinxsidebar">
        <div class="sphinxsidebarwrapper">
            <h3><a href="../contents.html">Table Of Contents</a></h3>
            <ul>
<li><a class="reference" href="">dojo.dnd package</a><ul>
<li><a class="reference" href="#introduction">Introduction</a><ul>
<li><a class="reference" href="#user-interface">User interface</a></li>
</ul>
</li>
<li><a class="reference" href="#dojo-dnd-principals">dojo.dnd principals</a><ul>
<li><a class="reference" href="#container">Container</a><ul>
<li><a class="reference" href="#constructor">Constructor</a></li>
<li><a class="reference" href="#default-creator">Default creator</a></li>
<li><a class="reference" href="#public-methods-and-attributes">Public methods and attributes</a></li>
<li><a class="reference" href="#event-processors">Event processors</a></li>
<li><a class="reference" href="#css-classes">CSS classes</a></li>
</ul>
</li>
<li><a class="reference" href="#selector">Selector</a><ul>
<li><a class="reference" href="#id2">Constructor</a></li>
<li><a class="reference" href="#id3">Public methods and attributes</a></li>
<li><a class="reference" href="#id4">Event processors</a></li>
<li><a class="reference" href="#id5">CSS classes</a></li>
</ul>
</li>
<li><a class="reference" href="#source">Source</a><ul>
<li><a class="reference" href="#id6">Constructor</a></li>
<li><a class="reference" href="#id7">Public methods and attributes</a></li>
<li><a class="reference" href="#id8">Event processors</a></li>
<li><a class="reference" href="#topic-processors">Topic processors</a></li>
<li><a class="reference" href="#id9">CSS classes</a></li>
</ul>
</li>
<li><a class="reference" href="#target">Target</a></li>
<li><a class="reference" href="#autosource">AutoSource</a></li>
<li><a class="reference" href="#avatar">Avatar</a><ul>
<li><a class="reference" href="#id10">CSS classes</a></li>
</ul>
</li>
<li><a class="reference" href="#manager">Manager</a><ul>
<li><a class="reference" href="#id11">Public methods and attributes</a></li>
<li><a class="reference" href="#id12">Event processors</a></li>
<li><a class="reference" href="#id13">Topic processors</a></li>
<li><a class="reference" href="#id14">CSS classes</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#dojo-dnd-move-principals">dojo.dnd.move principals</a><ul>
<li><a class="reference" href="#moveable">Moveable</a><ul>
<li><a class="reference" href="#id15">Constructor</a></li>
<li><a class="reference" href="#id16">Public methods and attributes</a></li>
<li><a class="reference" href="#id17">Event processors</a></li>
<li><a class="reference" href="#id18">Topic processors</a></li>
<li><a class="reference" href="#id19">CSS classes</a></li>
</ul>
</li>
<li><a class="reference" href="#mover">Mover</a><ul>
<li><a class="reference" href="#id20">Constructor</a></li>
<li><a class="reference" href="#id21">Public methods and attributes</a></li>
<li><a class="reference" href="#id22">Event processors</a></li>
</ul>
</li>
<li><a class="reference" href="#specialized-moveables">Specialized Moveables</a><ul>
<li><a class="reference" href="#constrainedmoveable">constrainedMoveable</a></li>
<li><a class="reference" href="#boxconstrainedmoveable">boxConstrainedMoveable</a></li>
<li><a class="reference" href="#parentconstrainedmoveable">parentConstrainedMoveable</a></li>
<li><a class="reference" href="#timedmoveable">TimedMoveable</a></li>
</ul>
</li>
</ul>
</li>
<li><a class="reference" href="#subclassing-dnd-classes">Subclassing DnD classes</a></li>
<li><a class="reference" href="#summary-of-css-classes">Summary of CSS classes</a><ul>
<li><a class="reference" href="#body">body</a></li>
<li><a class="reference" href="#source-target-dojo-dnd">Source/target (dojo.dnd)</a></li>
<li><a class="reference" href="#dnd-item-dojo-dnd">DnD item (dojo.dnd)</a></li>
<li><a class="reference" href="#dnd-handles-dojo-dnd">DnD handles (dojo.dnd)</a></li>
<li><a class="reference" href="#avatar-dojo-dnd">Avatar (dojo.dnd)</a></li>
<li><a class="reference" href="#dragged-node-dojo-dnd-move">Dragged node (dojo.dnd.move)</a></li>
</ul>
</li>
<li><a class="reference" href="#summary-of-topics">Summary of topics</a></li>
<li><a class="reference" href="#available-tests">Available tests</a></li>
<li><a class="reference" href="#external-tutorials-and-documentation">External tutorials and documentation</a></li>
<li><a class="reference" href="#tips">Tips</a></li>
</ul>
</li>
</ul>

            <h4>Previous topic</h4>
            <p class="topless"><a href="disconnect.html"
                                  title="previous chapter">dojo.disconnect</a></p>
            <h4>Next topic</h4>
            <p class="topless"><a href="dnd/Moveable.html"
                                  title="next chapter">dojo.dnd.Moveable</a></p>
            <h3>This Page</h3>
            <ul class="this-page-menu">
              <li><a href="../_sources/dojo/dnd.txt"
                     rel="nofollow">Show Source</a></li>
            </ul>
        </div>
      </div>
		  </div>
		  <div id="contentLeft">
		    <div class="bodywrapper">
		      <div class="body">
			
  <div class="section" id="dojo-dnd-package">
<span id="dojo-dnd"></span><h1><a class="toc-backref" href="#id25">dojo.dnd package<a class="headerlink" href="#dojo-dnd-package" title="Permalink to this headline">¶</a></a></h1>
<table class="docutils field-list" frame="void" rules="none">
<col class="field-name" />
<col class="field-body" />
<tbody valign="top">
<tr class="field"><th class="field-name">Status:</th><td class="field-body">Release</td>
</tr>
<tr class="field"><th class="field-name">Version:</th><td class="field-body">1.2.2 (current)</td>
</tr>
<tr class="field"><th class="field-name">Available:</th><td class="field-body">since 0.9</td>
</tr>
<tr class="field"><th class="field-name">Author:</th><td class="field-body">Eugene Lazutkin</td>
</tr>
</tbody>
</table>
<div class="contents topic">
<p class="topic-title first"><a id="contents" name="contents">Contents</a></p>
<ul class="simple">
<li><a class="reference" href="#dojo-dnd-package" id="id25" name="id25">dojo.dnd package</a><ul>
<li><a class="reference" href="#introduction" id="id26" name="id26">Introduction</a></li>
<li><a class="reference" href="#dojo-dnd-principals" id="id27" name="id27">dojo.dnd principals</a></li>
<li><a class="reference" href="#dojo-dnd-move-principals" id="id28" name="id28">dojo.dnd.move principals</a></li>
<li><a class="reference" href="#subclassing-dnd-classes" id="id29" name="id29">Subclassing DnD classes</a></li>
<li><a class="reference" href="#summary-of-css-classes" id="id30" name="id30">Summary of CSS classes</a></li>
<li><a class="reference" href="#summary-of-topics" id="id31" name="id31">Summary of topics</a></li>
<li><a class="reference" href="#available-tests" id="id32" name="id32">Available tests</a></li>
<li><a class="reference" href="#external-tutorials-and-documentation" id="id33" name="id33">External tutorials and documentation</a></li>
<li><a class="reference" href="#tips" id="id34" name="id34">Tips</a></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="introduction">
<h2><a class="toc-backref" href="#id26">Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></a></h2>
<p>This package was built after we learned from mistakes made in <tt class="docutils literal"><span class="pre">dojo.dnd</span> <span class="pre">0.4</span></tt>:</p>
<ul class="simple">
<li>The old package relied on position calculations, which fail in many corner cases (the browsers are to blame), and potentially can consume a lot of CPU cycles depending on complexity of the underlying HTML (deeper embedding means more time spent going over parent chains). The new package doesn&#8217;t do any position calculations instead relying on mouse events <tt class="docutils literal"><span class="pre">onmouseover</span></tt> and <tt class="docutils literal"><span class="pre">onmouseout</span></tt>. In order to do that we had to change the visual metaphor: the old DnD was dragging the object directly (it doesn&#8217;t make much sense when dragging several objects), the new one uses an avatar to represent dragged objects. The avatar is shifted, so it doesn&#8217;t obscure objects under the mouse giving the better visibility. Additionally it is possible to represent objects in the avatar differently. More on that later.</li>
<li>The old package attached event handlers to all draggable items, which slowed down the browser in case of a lot of objects. The new package works with containers, which are responsible for individual items. It scales much better.</li>
</ul>
<p>The old style dragging is useful in some cases, mostly because it looks intuitive for dragging single items. The new DnD accommodates it with a special sub-package <em>dojo.dnd.move</em>.</p>
<p>The DnD (both <em>dojo.dnd</em> and <em>dojo.dnd.move</em> packages) is implemented as state machines, which reflect their state by adding and removing classes to relevant objects, which gives the ultimate flexibility over customizing the look-and-feel.</p>
<p>Every DnD container and DnD item has a notion of type. The type is represented by a unique text string. Every container and item has an array of types assigned to them. In order to transfer (drop) items on a container they should have at least one type in common. When transferring a group of items to a container all items should have at least one type in common with the container. Otherwise the transfer is denied. If the list of types is not specified <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt> is assumed.</p>
<p>The <em>dojo.dnd</em> supports copy and move styles of DnD out of the box.</p>
<div class="section" id="user-interface">
<h3>User interface<a class="headerlink" href="#user-interface" title="Permalink to this headline">¶</a></h3>
<p>The existing implementation supports a <em>linear</em> container paradigm:</p>
<ul class="simple">
<li>Selection of an item on a mouse click.</li>
<li>Adding an item to the existing selection by ctrl+click.</li>
<li>Selecting a range of items by shift+click.</li>
<li>Adding a range of items by ctrl+shift+click.</li>
</ul>
<p>(On Macintosh the Meta key is used instead of the Ctrl.)
In order to show an insertion point correctly it is possible to specify if we deal with a vertical or horizontal container.</p>
<p>See <a class="reference" href="#selector">Selector</a> for more details.</p>
</div>
</div>
<div class="section" id="dojo-dnd-principals">
<h2><a class="toc-backref" href="#id27"><span class="target" id="id1">dojo.dnd</span> principals<a class="headerlink" href="#dojo-dnd-principals" title="Permalink to this headline">¶</a></a></h2>
<p>The <tt class="docutils literal"><span class="pre">dojo.dnd</span></tt> consists of 5 classes: <a class="reference" href="#container">Container</a>, <a class="reference" href="#selector">Selector</a>, <a class="reference" href="#source">Source</a>, <a class="reference" href="#manager">Manager</a>, and <a class="reference" href="#avatar">Avatar</a>. The former three classes are responsible for DnD sources and targets. The latter two classes are singletons responsible for orchestration of DnD on the web page.</p>
<div class="section" id="container">
<h3>Container<a class="headerlink" href="#container" title="Permalink to this headline">¶</a></h3>
<p>The default implementation of <tt class="docutils literal"><span class="pre">dojo.dnd.Container</span></tt> represents a uniform linear collection of items. It knows when the mouse hovers over it, and when the mouse hovers over a particular item.</p>
<p>The draggable item is represented by an abstract data object, which can be anything. There is a function <tt class="docutils literal"><span class="pre">creator</span></tt>, which is called when we need to visualize a data item for the <a class="reference" href="#container">container</a>, or for the <a class="reference" href="#avatar">avatar</a>. It allows us to have different representations of the same data item in different containers and in the <a class="reference" href="#avatar">avatar</a>. More on that later.</p>
<div class="section" id="constructor">
<h4>Constructor<a class="headerlink" href="#constructor" title="Permalink to this headline">¶</a></h4>
<p>Constructor takes 2 parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; a DOM node or an id (string) of such node. This node represents a container. All draggable items will be direct descendants of this node (the important exception: a <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt> node, in this case items will be direct descendants of the embedded <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> node). If you want to override this default behavior, use <tt class="docutils literal"><span class="pre">dropParent</span></tt> attribute of <tt class="docutils literal"><span class="pre">params</span></tt> (see below).</li>
<li><tt class="docutils literal"><span class="pre">params</span></tt> &#8212; a dictionary object, which defines optional parameters. Following optional parameters are recognized:<ul>
<li><tt class="docutils literal"><span class="pre">creator(item,</span> <span class="pre">hint)</span></tt> &#8212; a creator function, which is used to build a representation of the data item.<ul>
<li><tt class="docutils literal"><span class="pre">item</span></tt> &#8212; a data item (an abstract object), which defines a draggable object. The creator function is solely responsible for the interpretation of this item.</li>
<li><tt class="docutils literal"><span class="pre">hint</span></tt> &#8212; an optional string, which hints at the purpose of the call. The creator function can use it to produce different visual representations. At the moment only one value is defined: <tt class="docutils literal"><span class="pre">&quot;avatar&quot;</span></tt>. When <tt class="docutils literal"><span class="pre">hint</span> <span class="pre">==</span> <span class="pre">&quot;avatar&quot;</span></tt> the creator can produce a special version for the avatar.</li>
<li>It should return an object with following members:<ul>
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; a DOM representation of the data item built by the creator. This node should have a unique id. If no id was assigned, it will be generated and assigned later by the container. This id will be used to identify this item everywhere.</li>
<li><tt class="docutils literal"><span class="pre">data</span></tt> &#8212; a data item itself. The creator can &#8220;massage&#8221; or even replace it.</li>
<li><tt class="docutils literal"><span class="pre">type</span></tt> &#8212; an array of strings, which identify the type of this item. It is used during the DnD operation to select compatible targets.</li>
</ul>
</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">skipForm</span></tt> &#8212; a Boolean flag. If it is true, the container passes selection and dragging operations to the browser, otherwise it suppresses them. By default it is false.</li>
<li><tt class="docutils literal"><span class="pre">dropParent</span></tt> &#8212; a DOM node below the main node, which serves as a physical container for data item nodes. It can be used to structure the visual design of your container. This value will be assigned to <tt class="docutils literal"><span class="pre">parent</span></tt> attribute of the container (see below).</li>
</ul>
</li>
</ul>
<p>During the construction the constructor checks immediate children of <tt class="docutils literal"><span class="pre">parent</span></tt> attribute (see below) for the presence of <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class. All such items are added as container&#8217;s children automatically. It is assumed that you already built the visual representation of the data item, so the creator function is not involved. Instead the necessary triplet formed like that:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; the node itself. If it doesn&#8217;t have an id, a unique id is generated for it.</li>
<li><tt class="docutils literal"><span class="pre">data</span></tt> &#8212; the content of <tt class="docutils literal"><span class="pre">dndData</span></tt> member of the node. If it is missing, <tt class="docutils literal"><span class="pre">node.innerHTML</span></tt> is used instead.</li>
<li><tt class="docutils literal"><span class="pre">type</span></tt> &#8212; the content of <tt class="docutils literal"><span class="pre">dndType</span></tt> member of the node split on &#8220;,&#8221; character. If it is missing, <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt> is used as the default type.</li>
</ul>
</div>
<div class="section" id="default-creator">
<h4>Default creator<a class="headerlink" href="#default-creator" title="Permalink to this headline">¶</a></h4>
<p>If the creator function was not specified, a default creator is used. The default creator does following things:</p>
<ul class="simple">
<li>It creates a context-appropriate node:<ul>
<li>If the container is <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt> or <tt class="docutils literal"><span class="pre">&lt;p&gt;</span></tt>-based, it will create a <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt> node.</li>
<li>If the container is <tt class="docutils literal"><span class="pre">&lt;ul&gt;</span></tt> or <tt class="docutils literal"><span class="pre">&lt;ol&gt;</span></tt>-based, it will create a <tt class="docutils literal"><span class="pre">&lt;li&gt;</span></tt> node.</li>
<li>If the container is <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>-based, it will create a <tt class="docutils literal"><span class="pre">&lt;tr&gt;&lt;td&gt;</span></tt> group of nodes, and it will be inserted in <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt>.</li>
<li>In all other contexts it will create a <tt class="docutils literal"><span class="pre">&lt;span&gt;</span></tt> node.</li>
<li>If the <tt class="docutils literal"><span class="pre">hint</span></tt> is <tt class="docutils literal"><span class="pre">&quot;avatar&quot;</span></tt> it will create a <tt class="docutils literal"><span class="pre">&lt;span&gt;</span></tt> node.</li>
</ul>
</li>
<li>If the date item is an object, it will test for the presence of <tt class="docutils literal"><span class="pre">data</span></tt> member. If it is present, it will be used as a data object. Otherwise the item itself will be used as a data object.</li>
<li>If the date item is an object, it will test for the presence of <tt class="docutils literal"><span class="pre">type</span></tt> member. If it is present, it will be used as a type object. Otherwise <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt> will be used as a type object.</li>
<li>It will set a content of the node to <tt class="docutils literal"><span class="pre">String(data)</span></tt>. You can override the <tt class="docutils literal"><span class="pre">toString()</span></tt> member function of your object to change how it is converted to the string. Or specify the <tt class="docutils literal"><span class="pre">creator</span></tt> function.</li>
<li>As any creator it returns a triplet object with newly created/identified <tt class="docutils literal"><span class="pre">node</span></tt>, <tt class="docutils literal"><span class="pre">data</span></tt>, and <tt class="docutils literal"><span class="pre">type</span></tt>.</li>
</ul>
<p>After the creator function was called the result is post-processed:</p>
<ul class="simple">
<li>If the returned node doesn&#8217;t have an <tt class="docutils literal"><span class="pre">id</span></tt>, the default unique id will be generated.</li>
<li>The returned node will be assigned a <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</li>
<li>If the returned <tt class="docutils literal"><span class="pre">type</span></tt> is not an array or missing, it will be replaced with <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt>.</li>
</ul>
</div>
<div class="section" id="public-methods-and-attributes">
<h4>Public methods and attributes<a class="headerlink" href="#public-methods-and-attributes" title="Permalink to this headline">¶</a></h4>
<p>Following public methods are defined:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">getAllNodes()</span></tt> &#8212; returns a <tt class="docutils literal"><span class="pre">NodeList</span></tt> of all controlled DOM nodes in the order they are listed in the container.</li>
<li><tt class="docutils literal"><span class="pre">insertNodes(data,</span> <span class="pre">before,</span> <span class="pre">anchor)</span></tt> &#8212; inserts data items before/after the anchor node. It returns the container object itself for easy chaining of calls.<ul>
<li><tt class="docutils literal"><span class="pre">data</span></tt> &#8212; an array of data items to be inserted. Each data item will be passed to the creator function, the result will be registered with the container, the node will be inserted according to <tt class="docutils literal"><span class="pre">before</span></tt> and <tt class="docutils literal"><span class="pre">anchor</span></tt> parameters.</li>
<li><tt class="docutils literal"><span class="pre">before</span></tt> &#8212; a boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, nodes will be added before the <tt class="docutils literal"><span class="pre">anchor</span></tt>, and after otherwise.</li>
<li><tt class="docutils literal"><span class="pre">anchor</span></tt> &#8212; a node to be used as a reference for the insertion. It should be an immediate child of the container node (or a child of <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> for the <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>-based node). If it is not specified, all items will be appended to the container node (or <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> for tables).</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">destroy()</span></tt> &#8212; prepares the container object to be garbage-collected. You cannot use the container object after it was destroyed.</li>
<li><tt class="docutils literal"><span class="pre">sync()</span></tt> &#8212; <em>(new in 1.2.2)</em> inspects all controlled DOM nodes updating internal structures by removing information of removed nodes, and adding newly added DOM nodes marked with <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</li>
</ul>
<p>The container object defines following public attributes:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">current</span></tt> &#8212; a DOM node, which corresponds to a child with a mouse hovering over it. If there is no such item, this variable is null.</li>
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; the DOM node of the container. This node is used to set up mouse event handlers for the container.</li>
<li><tt class="docutils literal"><span class="pre">parent</span></tt> &#8212; the DOM node, which is an immediate parent of DnD item nodes. In most cases it is the same as node, but in some cases it can be node&#8217;s descendant. Example: for tables <tt class="docutils literal"><span class="pre">node</span></tt> can point to <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>, while <tt class="docutils literal"><span class="pre">parent</span></tt> points to <tt class="docutils literal"><span class="pre">&lt;tbody&gt;</span></tt> (DnD item nodes will be <tt class="docutils literal"><span class="pre">&lt;tr&gt;</span></tt> nodes). You can freely change parent to achieve the desired behavior of your container by specifying <tt class="docutils literal"><span class="pre">dropParent</span></tt> parameter.</li>
<li><tt class="docutils literal"><span class="pre">creator</span></tt> &#8212; the creator function or <tt class="docutils literal"><span class="pre">null</span></tt>, if the default creator is used.</li>
<li><tt class="docutils literal"><span class="pre">skipForm</span></tt> &#8212; the flag propagated from the initial parameters.</li>
</ul>
<p>The heart of the Container is the <tt class="docutils literal"><span class="pre">map</span></tt> attribute:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">map</span></tt> &#8212; a dictionary, which is keyed by node ids. Each registered child has an entry in the <tt class="docutils literal"><span class="pre">map</span></tt> by its node id (this is why all nodes should have unique ids). <tt class="docutils literal"><span class="pre">map[id]</span></tt> returns an object with two attributes:<ul>
<li><tt class="docutils literal"><span class="pre">data</span></tt> &#8212; an associated data item.</li>
<li><tt class="docutils literal"><span class="pre">type</span></tt> &#8212; an associated array of types.</li>
</ul>
</li>
</ul>
<p>It is not recommended to access <tt class="docutils literal"><span class="pre">map</span></tt> directly. There are several utility functions to access it. They can be used to virtualize the map, and you can use them with <tt class="docutils literal"><span class="pre">dojo.connect()</span></tt> so you know when DnD items are added/removed/accessed and use it to customize the behavior:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">getItem(id)</span></tt> &#8212; returns an object with <tt class="docutils literal"><span class="pre">data</span></tt> and <tt class="docutils literal"><span class="pre">type</span></tt> described above, which are associated with the node corresponding to that <tt class="docutils literal"><span class="pre">id</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">setItem(id,</span> <span class="pre">obj)</span></tt> &#8212; associates an object <tt class="docutils literal"><span class="pre">obj</span></tt> with this <tt class="docutils literal"><span class="pre">id</span></tt>. <tt class="docutils literal"><span class="pre">obj</span></tt> should define <tt class="docutils literal"><span class="pre">data</span></tt> and <tt class="docutils literal"><span class="pre">type</span></tt> attributes.</li>
<li><tt class="docutils literal"><span class="pre">delItem(id)</span></tt> &#8212; deletes a record of the node with this <tt class="docutils literal"><span class="pre">id</span></tt>. <em>Warning: it does not delete the node from the container.</em></li>
<li><tt class="docutils literal"><span class="pre">clearItems()</span></tt> &#8212; delete all records. <em>Warning: it does not delete nodes from the container.</em></li>
<li><tt class="docutils literal"><span class="pre">forInItems(f,</span> <span class="pre">o)</span></tt> &#8212; similar to <tt class="docutils literal"><span class="pre">dojo.forEach()</span></tt> but goes over all items in the map. The function <tt class="docutils literal"><span class="pre">f</span></tt> will be called in the context <tt class="docutils literal"><span class="pre">o</span></tt> for every item in the <tt class="docutils literal"><span class="pre">map</span></tt> with following parameters:<ul>
<li><tt class="docutils literal"><span class="pre">obj</span></tt> &#8212; the corresponding object with <tt class="docutils literal"><span class="pre">data</span></tt> and <tt class="docutils literal"><span class="pre">type</span></tt> defined.</li>
<li><tt class="docutils literal"><span class="pre">id</span></tt> &#8212; the node id.</li>
<li><tt class="docutils literal"><span class="pre">map</span></tt> &#8212; the map object itself.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="event-processors">
<h4>Event processors<a class="headerlink" href="#event-processors" title="Permalink to this headline">¶</a></h4>
<p>Following event processors are defined: <tt class="docutils literal"><span class="pre">onMouseOver</span></tt>, <tt class="docutils literal"><span class="pre">onMouseOut</span></tt>. Two pseudo-events are defined: <tt class="docutils literal"><span class="pre">onOverEvent</span></tt>, <tt class="docutils literal"><span class="pre">onOutEvent</span></tt>, which are cleaned up argument-less <tt class="docutils literal"><span class="pre">onMouseOver</span></tt> and <tt class="docutils literal"><span class="pre">onMouseOut</span></tt> events (otherwise they can be fired several times without actually leaving the container).</p>
</div>
<div class="section" id="css-classes">
<h4>CSS classes<a class="headerlink" href="#css-classes" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the container object:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndContainer</span></tt> &#8212; assigned to each container node during the construction.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndContainerOver</span></tt> &#8212; assigned when the mouse hovers over the container.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> &#8212; assigned to every new data item node. It should be assigned to every item before the container construction, if you want it to be added automatically by the constructor.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemOver</span></tt> &#8211; assigned to a data item node when the mouse hovers over the this item. This class is assigned in addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</li>
</ul>
<p>Partial reason to add &#8220;over&#8221; states when the mouse hovers over instead of using CSS was to support it in Internet Explorer too.</p>
</div>
</div>
<div class="section" id="selector">
<h3>Selector<a class="headerlink" href="#selector" title="Permalink to this headline">¶</a></h3>
<p>The default implementation of Selector is built on top of <a class="reference" href="#container">Container</a> and adds the ability to select children items. Selector inherits all <a class="reference" href="#container">Container</a>&#8216;s methods and objects. Additionally it adds a notion of an anchor. The anchor is used to specify a point of insertion of other items. The selector assumes that the container is organized in a linear fashion either vertically (e.g., embedded <tt class="docutils literal"><span class="pre">&lt;div&gt;</span></tt>s, lists, tables) or horizontally (e.g., <tt class="docutils literal"><span class="pre">&lt;span&gt;</span></tt>s). This assumption allows to implement familiar UI paradigms: selection of one element with a mouse click, selection of an additional element with ctrl+click, linear group selection from the anchor to the clicked element with shift+click, selecting an additional linear group from the anchor to the clicked element with shift+ctrl+click. Obviously if you have more complex containers, you should implement different UI actions.</p>
<div class="section" id="id2">
<h4>Constructor<a class="headerlink" href="#id2" title="Permalink to this headline">¶</a></h4>
<p>Constructor takes the same two parameters as the <a class="reference" href="#container">Container</a>&#8216;s constructor. It understands more optional parameters and passes the rest to the underlying container. Following optional parameters are understood by the selector object:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">singular</span></tt> &#8212; a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, the user is allowed to select just one item, otherwise any number of items can be selected. It is <tt class="docutils literal"><span class="pre">false</span></tt> by default.</li>
<li><tt class="docutils literal"><span class="pre">autoSync</span></tt> &#8212; a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, Selector calls <a class="reference" href="#container">Container</a>&#8216;s <tt class="docutils literal"><span class="pre">sync()</span></tt> method for every <tt class="docutils literal"><span class="pre">onMouseDown</span></tt>. It helps when you add/remove DnD items using HTML DOM API, but can be taxing for containers with large number of DnD items. In order to be more efficient consider calling <tt class="docutils literal"><span class="pre">sync()</span></tt> method after the manipulations were done, or (even more efficient) adding new DnD items using <tt class="docutils literal"><span class="pre">insertNodes()</span></tt> method. The default value of this parameter is <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
</ul>
</div>
<div class="section" id="id3">
<h4>Public methods and attributes<a class="headerlink" href="#id3" title="Permalink to this headline">¶</a></h4>
<p>Following public methods are defined in addition to the container public methods:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">getSelectedNodes()</span></tt> &#8212; returns a <tt class="docutils literal"><span class="pre">NodeList</span></tt> of selected DOM nodes.</li>
<li><tt class="docutils literal"><span class="pre">selectNone()</span></tt> &#8212; remove the selection from all items. It returns the selector object itself for easy chaining of calls.</li>
<li><tt class="docutils literal"><span class="pre">selectAll()</span></tt> &#8212; selects all items. It returns the selector object itself for easy chaining of calls.</li>
<li><tt class="docutils literal"><span class="pre">deleteSelectedNodes()</span></tt> &#8212; deletes all selected nodes. It returns the selector object itself for easy chaining of calls.</li>
</ul>
<p>Following public method is redefined with new signature:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">insertNodes(addSelected,</span> <span class="pre">data,</span> <span class="pre">before,</span> <span class="pre">anchor)</span></tt> &#8212; the last three parameters are the same as in <a class="reference" href="#container">Container</a>. The first parameter is a flag, if it is <tt class="docutils literal"><span class="pre">true</span></tt> all newly added items will be added as selected, otherwise they will be added unselected.</li>
</ul>
<p>The container object defines following public attributes:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">selection</span></tt> &#8212; a dictionary object keyed by ids of selected nodes. No useful payload is attached to objects in the dictionary.</li>
<li><tt class="docutils literal"><span class="pre">anchor</span></tt> &#8212; the current anchor node or <tt class="docutils literal"><span class="pre">null</span></tt>.</li>
</ul>
</div>
<div class="section" id="id4">
<h4>Event processors<a class="headerlink" href="#id4" title="Permalink to this headline">¶</a></h4>
<p>Following event processors are defined: <tt class="docutils literal"><span class="pre">onMouseDown</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>. <tt class="docutils literal"><span class="pre">onMouseMove</span></tt> is attached by <tt class="docutils literal"><span class="pre">onOverEvent</span></tt> and detached by <tt class="docutils literal"><span class="pre">onOutEvent</span></tt> dynamically.</p>
</div>
<div class="section" id="id5">
<h4>CSS classes<a class="headerlink" href="#id5" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the selector object in addition to classes assigned the container object:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndItemSelected</span></tt> &#8212; assigned if a data item is selected but it is not an anchor (the last selected element). This class is assigned in addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemAnchor</span></tt> &#8212; assigned to an anchor data item. At any given time the selector can have zero or one anchor. This class is assigned in addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class. Being an anchor means that this item is selected.</li>
</ul>
</div>
</div>
<div class="section" id="source">
<h3>Source<a class="headerlink" href="#source" title="Permalink to this headline">¶</a></h3>
<p>The source object represents a source of items for drag-and-drop operations. It is used to represent DnD targets as well. In order to be compatible your custom sources should emulate the common source API. Instances of this class can be created from the HTML markup automatically by <tt class="docutils literal"><span class="pre">dojo.parser</span></tt> using <tt class="docutils literal"><span class="pre">dojoType=&quot;dojo.dnd.Source&quot;</span></tt>.</p>
<p>The default implementation of the source is built on top of <a class="reference" href="#selector">Selector</a>, and adds the ability to start a DnD operation, and participate in the orchestration of the DnD. <a class="reference" href="#source">Source</a> inherits all <a class="reference" href="#selector">Selector</a>&#8216;s (and <a class="reference" href="#container">Container</a>&#8216;s) methods and objects. User can initiate the DnD operation by dragging items (click and move without releasing the mouse). The DnD operation can be used to rearrange items within a single source, or items can be moved or copied between two sources. User can select whether she wants to copy or move items by pressing the Ctrl button during the operation. If it is pressed, items will be copied, otherwise they will be moved. This behavior can be overwritten programmatically.</p>
<div class="section" id="id6">
<h4>Constructor<a class="headerlink" href="#id6" title="Permalink to this headline">¶</a></h4>
<p>Constructor takes the same two parameters as the container&#8217;s <a class="reference" href="#selector">selector</a>. It understands more optional parameters and passes the rest to the underlying <a class="reference" href="#selector">selector</a>. Following optional parameters are understood by the source object:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">isSource</span></tt> &#8212; a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, this object can be used to start the DnD operation, otherwise it can serve only as a target. It is <tt class="docutils literal"><span class="pre">true</span></tt> by default.</li>
<li><tt class="docutils literal"><span class="pre">accept</span></tt> &#8212; an array of strings. It defines what types can be accepted by this object, when it is used as a target. The default is <tt class="docutils literal"><span class="pre">[&quot;text&quot;]</span></tt>. If the array is empty it means that this source cannot be a target.</li>
<li><tt class="docutils literal"><span class="pre">horizontal</span></tt> &#8212; a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source is based on the horizontally organized list container, otherwise it is based on the vertical one. The default is <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">withHandles</span></tt> &#8212; a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, an item can be dragged only by a predefined node inside the item, otherwise the whole item can be used for dragging. By default it is <tt class="docutils literal"><span class="pre">false</span></tt>. The handle should be a descendant of the item node and should be marked with class <tt class="docutils literal"><span class="pre">dojoDndHandle</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">copyOnly</span></tt> &#8212; a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source doesn&#8217;t allow to move items out of it, any DnD operation will copy items from such sources. By default it is <tt class="docutils literal"><span class="pre">false</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">selfCopy</span></tt> &#8212; <em>(new in 1.2.2)</em> a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source copies items by default when dropping on itself. It is <tt class="docutils literal"><span class="pre">false</span></tt> by default. This flag has meaning only if <tt class="docutils literal"><span class="pre">copyOnly</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">selfAccept</span></tt> &#8212; <em>(new in 1.2.2)</em> a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the source accepts its own items. It is <tt class="docutils literal"><span class="pre">true</span></tt> by default. This flag has meaning only if <tt class="docutils literal"><span class="pre">copyOnly</span></tt> is <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">delay</span></tt> &#8212; <em>(new in 1.2.2)</em> a number, which defines the move delay in pixels before detecting a drag; 0 (no delay) by default.</li>
</ul>
</div>
<div class="section" id="id7">
<h4>Public methods and attributes<a class="headerlink" href="#id7" title="Permalink to this headline">¶</a></h4>
<p>Following public methods are defined (they can be replace to change the DnD behavior):</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">checkAcceptance(source,</span> <span class="pre">nodes)</span></tt> &#8212; returns <tt class="docutils literal"><span class="pre">true</span></tt>, if this object can accept <tt class="docutils literal"><span class="pre">nodes</span></tt> from <tt class="docutils literal"><span class="pre">source</span></tt>. The default implementation checks item&#8217;s types with accepted types of the object, and rejects the operation, if there is no full match. Such objects are marked as disabled targets and they do not participate in the current DnD operation. The source of items can always accept its items regardless of the match (for exceptions see the definition of <tt class="docutils literal"><span class="pre">selfAccept</span></tt> above) preventing the situation when user started to drag items and cannot find a suitable target, and cannot return them back. Please take it into consideration when replacing this method. Target&#8217;s <tt class="docutils literal"><span class="pre">checkAcceptance()</span></tt> is called during the DnD in progress when user hovers above it. Following parameters are passed to the method:<ul>
<li><tt class="docutils literal"><span class="pre">source</span></tt> &#8212; the source object for the dragged items.</li>
<li><tt class="docutils literal"><span class="pre">nodes</span></tt> &#8212; a list of DOM nodes.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">copyState(keyPressed)</span></tt> &#8212; returns <tt class="docutils literal"><span class="pre">true</span></tt> if the copy operation should be performed, the move will be performed otherwise. The default implementation checks the <tt class="docutils literal"><span class="pre">copyOnly</span></tt> and <tt class="docutils literal"><span class="pre">selfCopy</span></tt> parameters described above. This method can be replaced if you want to implement a more complex logic. Following parameters are passed in:<ul>
<li><tt class="docutils literal"><span class="pre">keyPressed</span></tt> &#8212; a Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, user pressed the <tt class="docutils literal"><span class="pre">copy</span></tt> key.</li>
<li><tt class="docutils literal"><span class="pre">self</span></tt> &#8212; a Boolean flag. If it is <tt class="docutils literal"><span class="pre">true</span></tt>, we are about to drop items on itself.</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id8">
<h4>Event processors<a class="headerlink" href="#id8" title="Permalink to this headline">¶</a></h4>
<p>Following event handlers are overloaded: <tt class="docutils literal"><span class="pre">onMouseDown</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>, and <tt class="docutils literal"><span class="pre">onMouseMove</span></tt>. They are used to perform additional actions required by <a class="reference" href="#source">Source</a>.</p>
<p>Following local events are defined by <a class="reference" href="#source">Source</a>, which are meant to be overridden or connected with <tt class="docutils literal"><span class="pre">dojo.connect()</span></tt>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">onDrop(source,</span> <span class="pre">nodes,</span> <span class="pre">copy)</span></tt> &#8212; <em>(new in 1.2.2)</em> this method is called when DnD items is dropped in this target. The default implementation calls <tt class="docutils literal"><span class="pre">onDropExternal()</span></tt> or <tt class="docutils literal"><span class="pre">onDropInternal()</span></tt> based on the value of <tt class="docutils literal"><span class="pre">source</span></tt> (see below). Following parameters are passed in:<ul>
<li><tt class="docutils literal"><span class="pre">source</span></tt> &#8212; the source of dragged items, can be the same object as the target.</li>
<li><tt class="docutils literal"><span class="pre">nodes</span></tt> &#8212; the array of DOM nodes to be dropped. Their ids can be used to access associated types and data.</li>
<li><tt class="docutils literal"><span class="pre">copy</span></tt> &#8212; the Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the target is requested to copy items, otherwise the target should move items.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">onDropExternal(source,</span> <span class="pre">nodes,</span> <span class="pre">copy)</span></tt> &#8212; <em>(new in 1.2.2)</em> this method is called by the default implementation of <tt class="docutils literal"><span class="pre">onDrop()</span></tt> only if we have an external drop meaning that the source is different from the target. All parameters are the same as in <tt class="docutils literal"><span class="pre">onDrop()</span></tt>. The default implementation performs the drop as instructed.</li>
<li><tt class="docutils literal"><span class="pre">onDropInternal(nodes,</span> <span class="pre">copy)</span></tt> &#8212; <em>(new in 1.2.2)</em> this method is called by the default implementation of <tt class="docutils literal"><span class="pre">onDrop()</span></tt> only if we have an internal drop meaning that the source is the same as the target. All parameters are the same as in <tt class="docutils literal"><span class="pre">onDrop()</span></tt>, but <tt class="docutils literal"><span class="pre">source</span></tt> parameter is skipped as redundant (it is the same as <tt class="docutils literal"><span class="pre">this</span></tt>). The default implementation performs the drop as instructed.</li>
<li><tt class="docutils literal"><span class="pre">onDraggingOver()</span></tt> &#8212; this method is called during the DnD operation in progress when the mouse is over this target, and it is not disabled for any reasons. The default implementation does nothing.</li>
<li><tt class="docutils literal"><span class="pre">onDraggingOut()</span></tt> &#8212; this method is called during the DnD operation in progress when the mouse went out this target, and it is not disabled for any reasons. The default implementation does nothing.</li>
</ul>
</div>
<div class="section" id="topic-processors">
<h4>Topic processors<a class="headerlink" href="#topic-processors" title="Permalink to this headline">¶</a></h4>
<p>Following topic listeners are defined: <tt class="docutils literal"><span class="pre">onDndSourceOver</span></tt>, <tt class="docutils literal"><span class="pre">onDndStart</span></tt>, <tt class="docutils literal"><span class="pre">onDndDrop</span></tt>, <tt class="docutils literal"><span class="pre">onDndCancel</span></tt>. These topics are published by the <a class="reference" href="#manager">manager</a>. If you want to override topic listeners, please read <em>Summary of topics</em>.</p>
<p><strong>Warning: in most cases you want to use events. Topics are low-level constructs, which are used internally.</strong></p>
</div>
<div class="section" id="id9">
<h4>CSS classes<a class="headerlink" href="#id9" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the source object in addition to classes assigned by <a class="reference" href="#selector">Selector</a> and <a class="reference" href="#container">Container</a> objects:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndHorizontal</span></tt> &#8212; assigned to the container node during the construction, if this object represents a horizontal list of <tt class="docutils literal"><span class="pre">dndItems</span></tt> &#8212; its <tt class="docutils literal"><span class="pre">horizontal</span></tt> property set to <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> &#8212; assigned to the container node during the construction, if this object can be used as a source of DnD items &#8212; its <tt class="docutils literal"><span class="pre">isSource</span></tt> property set to true.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt> &#8212; assigned to the container node during the active DnD operation when user copies items from it, e.g., pressed the Ctrl key while dragging. When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt> &#8212; assigned to the container node during the active DnD operation when user moves items from it, e.g., the Ctrl key is not pressed while dragging. When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt> &#8212; assigned to the container node during the construction, if this object can potentially accept DnD items &#8212; its <tt class="docutils literal"><span class="pre">accept</span></tt> list is not empty.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt> &#8212; assigned to the container node during the active DnD operation when this node cannot accept currently dragged items, e.g., because it doesn&#8217;t accept items of these types. When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt> class is removed.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt> &#8212; assigned to the data item node during the active DnD operation if transferred items will be inserted before this item. This class is assigned in addition to all other classes.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt> &#8212; assigned to the data item node during the active DnD operation if transferred items will be inserted after this item. This class is assigned in addition to all other classes.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndHandle</span></tt> &#8212; assigned to handles of item nodes. See <tt class="docutils literal"><span class="pre">withHandles</span></tt> parameter of <a class="reference" href="#source">Source</a> above.</li>
</ul>
<p><tt class="docutils literal"><span class="pre">dojoDndSource</span></tt>, <tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt>, and <tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt> are mutually exclusive. <tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt>, and <tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt> are mutually exclusive. <tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt>, <tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt>, <tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt>, <tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt>, and <tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt> can be assigned only during the active Dnd operation. See the manager&#8217;s classes below to see what additional classes can be used for custom styling. Use <tt class="docutils literal"><span class="pre">dojoDndHorizontal</span></tt> with <tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt> and <tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt> to create visually appropriate insertion markers for horizontal (before, after) and vertical (above, below) containers.</p>
</div>
</div>
<div class="section" id="target">
<h3>Target<a class="headerlink" href="#target" title="Permalink to this headline">¶</a></h3>
<p>Essentially it is <a class="reference" href="#source">Source</a> wrapped in with <tt class="docutils literal"><span class="pre">isSource</span></tt> set to <tt class="docutils literal"><span class="pre">false</span></tt>. Instances of this class can be created from the HTML markup automatically by <tt class="docutils literal"><span class="pre">dojo.parser</span></tt> using <tt class="docutils literal"><span class="pre">dojoType=&quot;dojo.dnd.Target&quot;</span></tt>.</p>
</div>
<div class="section" id="autosource">
<h3>AutoSource<a class="headerlink" href="#autosource" title="Permalink to this headline">¶</a></h3>
<p>Essentially it is <a class="reference" href="#source">Source</a> wrapped in with <tt class="docutils literal"><span class="pre">autoSync</span></tt> set to <tt class="docutils literal"><span class="pre">true</span></tt>. Instances of this class can be created from the HTML markup automatically by <tt class="docutils literal"><span class="pre">dojo.parser</span></tt> using <tt class="docutils literal"><span class="pre">dojoType=&quot;dojo.dnd.AutoSource&quot;</span></tt>.</p>
</div>
<div class="section" id="avatar">
<h3>Avatar<a class="headerlink" href="#avatar" title="Permalink to this headline">¶</a></h3>
<p>Avatar is a class for the object (the singleton pattern) that represents dragged items during DnD operations. You can replace it or style it if you need to customize the look of DnD.</p>
<p>Following methods should be implemented:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">constructor(manager)</span></tt> &#8212; the constructor of the class takes a single parameter &#8212; the instance of <a class="reference" href="#manager">Manager</a>, which is used to reflect the state of the DnD operation in progress visually. The constructor is called (and the avatar object is created) only when the manager decided to start a DnD operation. In this case <a class="reference" href="#manager">Manager</a> calls its method <tt class="docutils literal"><span class="pre">makeAvatar()</span></tt>. By default Avatar constructs <tt class="docutils literal"><span class="pre">&lt;table&gt;</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">destroy()</span></tt> &#8212; this method is called when the DnD operation is finished, the avatar is unneeded, and is about to be recycled.</li>
<li><tt class="docutils literal"><span class="pre">update()</span></tt> &#8212; this method is called, when the state of the manager changes. It is used to reflect manager&#8217;s changes visually. Usually this method is called by <a class="reference" href="#manager">Manager</a> automatically.</li>
<li>:ref:<tt class="docutils literal"><span class="pre">generateText()</span></tt> &#8212; semi-public method, which is called by <tt class="docutils literal"><span class="pre">update()</span></tt> to render the header test. The default implementation returns a number of dragged items as a string. You can override this method for localization purposes, or to change the text how you like it.</li>
</ul>
<p>The default implementation of the Avatar class does following:</p>
<ul class="simple">
<li>It creates an absolutely positioned table of up to 6 rows.</li>
<li>The first row (the header) is populated with a text generated by :ref:<tt class="docutils literal"><span class="pre">generateText()</span></tt> method.</li>
<li>Next rows are populated with DOM nodes generated by the creator function of the current source with hint &#8220;avatar&#8221; (see above the description of the creator function) for data items. Up to 5 rows are populated with decreasing opacity.</li>
</ul>
<p>If you want to override the avatar with something totally custom, the best way to do it is to override <a class="reference" href="#manager">Manager</a>&#8216;s <tt class="docutils literal"><span class="pre">makeAvatar()</span></tt> to return your own instance.</p>
<div class="section" id="id10">
<h4>CSS classes<a class="headerlink" href="#id10" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used to style the avatar:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndAvatar</span></tt> &#8212; assigned to the avatar (the table).</li>
<li><tt class="docutils literal"><span class="pre">dojoDndAvatarHeader</span></tt> &#8212; assigned to the first row (the header).</li>
<li><tt class="docutils literal"><span class="pre">dojoDndAvatarItem</span></tt> &#8212; assigned to the avatar item rows.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndAvatarCanDrop</span></tt> &#8212; added to the avatar (the table) when the mouse is over a target, which can accept transferred items. Otherwise it is removed.</li>
</ul>
</div>
</div>
<div class="section" id="manager">
<h3>Manager<a class="headerlink" href="#manager" title="Permalink to this headline">¶</a></h3>
<p>Manager is a small class, which implements a business logic of DnD and orchestrates the visualization of this process. It accepts events from sources/targets, creates the avatar, and checks the validity of the drop. At any given moment there is only one instance of this class (the singleton pattern), which can be accessed by <tt class="docutils literal"><span class="pre">dojo.dnd.manager()</span></tt> function. User does not need to instantiate this object explicitly. It is done automatically when DnD modules are included.</p>
<p>This class or its instance can be monkey patched or replaced completely, if you want to change its functionality.</p>
<div class="section" id="id11">
<h4>Public methods and attributes<a class="headerlink" href="#id11" title="Permalink to this headline">¶</a></h4>
<p>Following public methods are defined to be called by sources:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">startDrag(source,</span> <span class="pre">nodes,</span> <span class="pre">copy)</span></tt> &#8212; starts the DnD operations. The parameters are copied as public member variables of the manager with the same names. This method creates the avatar by calling <tt class="docutils literal"><span class="pre">this.makeAvatar()</span></tt> and assigning it to the <tt class="docutils literal"><span class="pre">avatar</span></tt> public member. Information on parameters:
* <tt class="docutils literal"><span class="pre">source</span></tt> &#8212; the source of dragged items, can be the same object as the target.
* <tt class="docutils literal"><span class="pre">nodes</span></tt> &#8212; the array of DOM nodes to be dropped. Their ids can be used to access associated types and data.
* <tt class="docutils literal"><span class="pre">copy</span></tt> &#8212; the Boolean flag. If <tt class="docutils literal"><span class="pre">true</span></tt>, the target is requested to copy items, otherwise the target should move items.</li>
<li><tt class="docutils literal"><span class="pre">stopDrag()</span></tt> &#8212; resets the DnD operation by resetting all public members. It is not enough to call this method to abort the DnD. Before calling it you should publish dnd/cancel topic (or dnd/drop, if you forcing the drop). See more information on topics below.</li>
<li><tt class="docutils literal"><span class="pre">canDrop(flag)</span></tt> &#8212; called by the current target to notify that it can accept the DnD items, if flag is <tt class="docutils literal"><span class="pre">true</span></tt>. Otherwise it refuses to accept them.</li>
</ul>
<p>Following methods deal with the avatar and can be overridden, if you want something different:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">makeAvatar()</span></tt> &#8212; returns the avatar&#8217;s node. By default it creates an instance of <a class="reference" href="#avatar">Avatar</a> passing itself as a parameter.</li>
<li><tt class="docutils literal"><span class="pre">updateAvatar()</span></tt> &#8212; updates avatar to reflect changes in the current DnD operation, e.g., copy vs. move, cannot drop at this point.</li>
</ul>
<p>If you want to use a custom avatar, you can override these methods to do whatever you like.</p>
<p>Following public properties are defined on the manager (can be overwritten if desired):</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">OFFSET_X</span></tt> &#8212; the horizontal offset in pixels between the mouse pointer position and the left edge of the avatar.</li>
<li><tt class="docutils literal"><span class="pre">OFFSET_Y</span></tt> &#8212; the vertical offset in pixels between the mouse pointer position and the top edge of the avatar.</li>
</ul>
<p>Following public properties are used by the manager during the active DnD operation:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">source</span></tt> &#8212; the source of DnD items.</li>
<li><tt class="docutils literal"><span class="pre">nodes</span></tt> &#8212; the list of transferred DnD items.</li>
<li><tt class="docutils literal"><span class="pre">copy</span></tt> &#8212; Boolean value to track the copy/move status.</li>
<li><tt class="docutils literal"><span class="pre">target</span></tt> &#8212; the selected target of the drop.</li>
</ul>
</div>
<div class="section" id="id12">
<h4>Event processors<a class="headerlink" href="#id12" title="Permalink to this headline">¶</a></h4>
<p>Following events are processed by the manager to the body: <tt class="docutils literal"><span class="pre">onMouseMove</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>, <tt class="docutils literal"><span class="pre">onKeyDown</span></tt>, <tt class="docutils literal"><span class="pre">onKeyUp</span></tt>. These events are attached only during the active DnD operation. Following keys have a special meaning for the manager:</p>
<ul class="simple">
<li>Ctrl key &#8212; when it is pressed the copy semantics is assumed. Otherwise the move is assumed.</li>
<li>Esc key &#8212; when it is pressed the DnD operation is immediately canceled.</li>
</ul>
</div>
<div class="section" id="id13">
<h4>Topic processors<a class="headerlink" href="#id13" title="Permalink to this headline">¶</a></h4>
<p>Following topic events can be generated by the manager:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">/dnd/start</span></tt> &#8212; when DnD starts. Current <tt class="docutils literal"><span class="pre">source</span></tt>, <tt class="docutils literal"><span class="pre">nodes</span></tt>, and the <tt class="docutils literal"><span class="pre">copy</span></tt> flag (see <tt class="docutils literal"><span class="pre">startDrag()</span></tt> for more info) are passed as parameters of this event.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/source/over</span></tt> &#8212; when the mouse moves over a source. The source in question is passed as a parameter. The same event is raised when the mouse goes out of a source. In this case <tt class="docutils literal"><span class="pre">null</span></tt> is passed as a parameter.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/drop/before</span></tt> &#8212; raised just before the drop. It can be used to capture the drop parameters. Parameters are the same as for <tt class="docutils literal"><span class="pre">/dnd/start</span></tt>, but reflect current values.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/drop</span></tt> &#8212; raised to perform a drop. Parameters are the same as for <tt class="docutils literal"><span class="pre">/dnd/start</span></tt> and one additional parameter is <tt class="docutils literal"><span class="pre">target</span></tt> (the object where items are dropped).</li>
<li><tt class="docutils literal"><span class="pre">/dnd/cancel</span></tt> &#8212; when DnD was canceled either by user (by hitting Esc), or by dropping items in illegal location.</li>
</ul>
<p><strong>During the processing of topics any listener can change the original parameters.</strong> It can be done by the target processing <tt class="docutils literal"><span class="pre">/dnd/drop</span></tt>. In most cases you want to use events local to sources/targets, instead of processing topics. See <a class="reference" href="#source">Source</a>&#8216;s <tt class="docutils literal"><span class="pre">onDrop</span></tt> for more details.</p>
</div>
<div class="section" id="id14">
<h4>CSS classes<a class="headerlink" href="#id14" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by the manager to style the DnD operation:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndCopy</span></tt> &#8212; assigned to <tt class="docutils literal"><span class="pre">body</span></tt> during the copy DnD operations.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndMove</span></tt> &#8212; assigned to <tt class="docutils literal"><span class="pre">body</span></tt> during the move DnD operations.</li>
</ul>
<p>No styles are assigned when there is no DnD in progress.</p>
</div>
</div>
</div>
<div class="section" id="dojo-dnd-move-principals">
<h2><a class="toc-backref" href="#id28"><span class="target" id="dojo-dnd-move">dojo.dnd.move</span> principals<a class="headerlink" href="#dojo-dnd-move-principals" title="Permalink to this headline">¶</a></a></h2>
<p>The DnD move consists of two principal classes and several specific implementations.</p>
<div class="section" id="moveable">
<h3>Moveable<a class="headerlink" href="#moveable" title="Permalink to this headline">¶</a></h3>
<p>Moveable is the main class, which is used to give the &#8220;moveable&#8221; property to a DOM node. Instances of this class can be created from the HTML markup automatically by <tt class="docutils literal"><span class="pre">dojo.parser</span></tt> using <tt class="docutils literal"><span class="pre">dojoType=&quot;dojo.dnd.Moveable&quot;</span></tt>.</p>
<div class="section" id="id15">
<h4>Constructor<a class="headerlink" href="#id15" title="Permalink to this headline">¶</a></h4>
<p>The constructor accepts following parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; a DOM node or an id (string) of such node. This node will be made moveable. Both <tt class="docutils literal"><span class="pre">relative</span></tt> and <tt class="docutils literal"><span class="pre">absolute</span></tt> nodes can be moved. Their <tt class="docutils literal"><span class="pre">left</span></tt> and <tt class="docutils literal"><span class="pre">top</span></tt> are assumed to be in pixels. All other nodes are converted to <tt class="docutils literal"><span class="pre">absolute</span></tt> nodes on the first drag.</li>
<li><tt class="docutils literal"><span class="pre">params</span></tt> &#8212; a dictionary object, which defines optional parameters. Following optional parameters are recognized:<ul>
<li><tt class="docutils literal"><span class="pre">handle</span></tt> &#8212; the node (or its id), which will be used as a drag handle. It should be a descendant of <tt class="docutils literal"><span class="pre">node</span></tt>. If it is <tt class="docutils literal"><span class="pre">null</span></tt> (the default), the <tt class="docutils literal"><span class="pre">node</span></tt> itself is used for dragging.</li>
<li><tt class="docutils literal"><span class="pre">delay</span></tt> &#8212; a number in pixels. When user started the drag we should wait for <tt class="docutils literal"><span class="pre">delay</span></tt> pixels before starting dragging the node. It is used to prevent accidental drags. The default is 0 (no delay).</li>
<li><tt class="docutils literal"><span class="pre">skip</span></tt> &#8212; a Boolean flag, which indicates that we should skip form elements when initiating drags, it is it <tt class="docutils literal"><span class="pre">true</span></tt>. Otherwise we drag the node no matter what. This parameter is used when we want to drag a form, but keep form elements usable, e.g., we can still select text in a text node. The default is <tt class="docutils literal"><span class="pre">false</span></tt>. When working with draggable form, the better lternative to <tt class="docutils literal"><span class="pre">skip=true</span></tt> is to define a drag handle instead.</li>
<li><tt class="docutils literal"><span class="pre">mover</span></tt> &#8212; the class to be used to create a mover (see <a class="reference" href="#mover">Mover</a>).</li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id16">
<h4>Public methods and attributes<a class="headerlink" href="#id16" title="Permalink to this headline">¶</a></h4>
<p>Following public members are available:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; the node to be dragged.</li>
</ul>
<p>Following public methods are defined:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">destroy()</span></tt> &#8212; should be call, when you want to remove the &#8220;moveable&#8221; behavior form the node.</li>
</ul>
</div>
<div class="section" id="id17">
<h4>Event processors<a class="headerlink" href="#id17" title="Permalink to this headline">¶</a></h4>
<p>Following public methods/events are defined (they can be used with <tt class="docutils literal"><span class="pre">dojo.connect()</span></tt> or overridden):</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">onDragDetected(evt)</span></tt> &#8212; called when the drag is detected. The default implementation creates a <a class="reference" href="#mover">mover</a>. Parameters:<ul>
<li><tt class="docutils literal"><span class="pre">evt</span></tt> &#8212; the event object, which triggered the drag.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">onFirstMove(mover)</span></tt> &#8212; called once after processing the first move event. The default implementation does nothing. Parameters:<ul>
<li><tt class="docutils literal"><span class="pre">mover</span></tt> &#8212; the <a class="reference" href="#mover">mover</a> object used to drag the node</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">onMoveStart(mover)</span></tt> &#8212; called when the move is about to start. The parameter is a <a class="reference" href="#mover">mover</a> object just like in <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>. The default implementation publishes the topic <tt class="docutils literal"><span class="pre">/dnd/move/start</span></tt>, adds <tt class="docutils literal"><span class="pre">dojoMove</span></tt> class to <tt class="docutils literal"><span class="pre">body</span></tt> node, and <tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt> class to the moved node.</li>
<li><tt class="docutils literal"><span class="pre">onMoveStop(mover)</span></tt> &#8212; called when the move is finished. The parameter is a <a class="reference" href="#mover">mover</a> object just like in <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>. The default implementation publishes the topic <tt class="docutils literal"><span class="pre">/dnd/move/stop</span></tt>, removes <tt class="docutils literal"><span class="pre">dojoMove</span></tt> class from <tt class="docutils literal"><span class="pre">body</span></tt> node, and <tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt> class from the moved node.</li>
<li><tt class="docutils literal"><span class="pre">onMove(mover,</span> <span class="pre">leftTop)</span></tt> &#8212; called on every update of <tt class="docutils literal"><span class="pre">node</span></tt>&#8216;s position. The default implementation calls <tt class="docutils literal"><span class="pre">onMoving()</span></tt>, sets new position of the <tt class="docutils literal"><span class="pre">node</span></tt> using <tt class="docutils literal"><span class="pre">style</span></tt>, and calls <tt class="docutils literal"><span class="pre">onMoved()</span></tt>. Parameters:<ul>
<li><tt class="docutils literal"><span class="pre">mover</span></tt> &#8212; the <a class="reference" href="#mover">mover</a> object for the current move.</li>
<li><tt class="docutils literal"><span class="pre">leftTop</span></tt> &#8212; <tt class="docutils literal"><span class="pre">{l,</span> <span class="pre">t}</span></tt> &#8212; an object which defines the new left and top position of the object by its attributes <tt class="docutils literal"><span class="pre">l</span></tt> and <tt class="docutils literal"><span class="pre">t</span></tt> respectively. Both of them are numbers in pixels.</li>
</ul>
</li>
<li><tt class="docutils literal"><span class="pre">onMoving(mover,</span> <span class="pre">leftTop)</span></tt> &#8212; called by the default implementation of <tt class="docutils literal"><span class="pre">onMove()</span></tt> before updating the <tt class="docutils literal"><span class="pre">node</span></tt>&#8216;s position. It uses the same parameters as <tt class="docutils literal"><span class="pre">onMove()</span></tt> above. You can update <tt class="docutils literal"><span class="pre">leftTop</span></tt> parameter to whatever you want. The default implementation does nothing.</li>
<li><tt class="docutils literal"><span class="pre">onMoved(mover,</span> <span class="pre">leftTop)</span></tt> &#8212; called by the default implementation of <tt class="docutils literal"><span class="pre">onMove()</span></tt> after updating the <tt class="docutils literal"><span class="pre">node</span></tt>&#8216;s position. It uses the same parameters as <tt class="docutils literal"><span class="pre">onMove()</span></tt> above. The default implementation does nothing.</li>
</ul>
<p>The most important events are <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt> and <tt class="docutils literal"><span class="pre">onMove()</span></tt>. The former can be used to set up some initial parameters for the move, and possibly update some DOM nodes. The latter implements the move itself. By overriding these two methods you can implement a variety of click-drag-release operations, e.g., a resize operation, a draw operation, and so on.</p>
<p>As you can see <tt class="docutils literal"><span class="pre">onMoving()</span></tt>, <tt class="docutils literal"><span class="pre">onMove()</span></tt>, and <tt class="docutils literal"><span class="pre">onMoved()</span></tt> fit the classic AOP before/after pattern. <tt class="docutils literal"><span class="pre">onMoving()</span></tt> can be used to actively modify move parameters, while <tt class="docutils literal"><span class="pre">onMoved()</span></tt> can be used for book-keeping. You may consider to override <tt class="docutils literal"><span class="pre">onMove()</span></tt> for your own purposes and use <tt class="docutils literal"><span class="pre">dojox.lang.aop</span></tt> to augment it however you like.</p>
<p>Following mouse event handlers are set up:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">onMouseDown</span></tt></li>
<li><tt class="docutils literal"><span class="pre">onMouseMove</span></tt> &#8212; can be set up by <tt class="docutils literal"><span class="pre">onMouseDown</span></tt> when executing the non-zero delay.</li>
<li><tt class="docutils literal"><span class="pre">onMouseUp</span></tt> &#8212; can be set up by <tt class="docutils literal"><span class="pre">onMouseDown</span></tt> to cancel the drag while processing the non-zero delay.</li>
</ul>
<p>Additionally <tt class="docutils literal"><span class="pre">ondragselect</span></tt> and <tt class="docutils literal"><span class="pre">onselectstart</span></tt> events are canceled by <tt class="docutils literal"><span class="pre">onSelectStart()</span></tt> handler.</p>
</div>
<div class="section" id="id18">
<h4>Topic processors<a class="headerlink" href="#id18" title="Permalink to this headline">¶</a></h4>
<p>Following topic events are raised by <a class="reference" href="#moveable">Moveable</a>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">/dnd/move/start</span></tt> &#8212; published by the default implementation of <tt class="docutils literal"><span class="pre">onMoveStart()</span></tt> passing the <a class="reference" href="#mover">mover</a> object as a parameter.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/move/stop</span></tt> &#8212; published by the default implementation of <tt class="docutils literal"><span class="pre">onMoveStop()</span></tt> passing the <a class="reference" href="#mover">mover</a> as a parameter.</li>
</ul>
</div>
<div class="section" id="id19">
<h4>CSS classes<a class="headerlink" href="#id19" title="Permalink to this headline">¶</a></h4>
<p>Following CSS classes are used by <a class="reference" href="#moveable">Moveable</a>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoMove</span></tt> &#8212; assigned to <tt class="docutils literal"><span class="pre">body</span></tt> when the move is in progress.</li>
<li><tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt> &#8212; assigned to the moved node when the move is in progress.</li>
</ul>
</div>
</div>
<div class="section" id="mover">
<h3>Mover<a class="headerlink" href="#mover" title="Permalink to this headline">¶</a></h3>
<p>Mover is a utility class, which actually handles events to move the node, and triggers appropriate high-level events on the connected host (usually <a class="reference" href="#moveable">Moveable</a>). Instances of this class exist only when the move is in progress. In some cases you can use it directly.</p>
<div class="section" id="id20">
<h4>Constructor<a class="headerlink" href="#id20" title="Permalink to this headline">¶</a></h4>
<p>The constructor accepts following parameters:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; a DOM node or an id (string) of such node. This node will be moved.</li>
<li><tt class="docutils literal"><span class="pre">evt</span></tt> &#8212; a mouse event, which actually indicated the start of the move. It is used to extract the coordinates of the mouse using <tt class="docutils literal"><span class="pre">pageX</span></tt> and <tt class="docutils literal"><span class="pre">pageY</span></tt> properties.</li>
<li><tt class="docutils literal"><span class="pre">host</span></tt> &#8212; a host object, which will be called by the mover during the move. It should define at least two methods: <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>, and <tt class="docutils literal"><span class="pre">onMove()</span></tt>, and two optional methods: <tt class="docutils literal"><span class="pre">onMoveStart()</span></tt> and <tt class="docutils literal"><span class="pre">onMoveStop()</span></tt>. See <a class="reference" href="#moveable">Moveable</a> for details.</li>
</ul>
</div>
<div class="section" id="id21">
<h4>Public methods and attributes<a class="headerlink" href="#id21" title="Permalink to this headline">¶</a></h4>
<p>Following public members are available:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">node</span></tt> &#8212; the node being dragged.</li>
<li><tt class="docutils literal"><span class="pre">mouseButton</span></tt> &#8212; a mouse button, which was pressed when starting the drag.</li>
<li><tt class="docutils literal"><span class="pre">marginBox</span></tt> &#8212; an object with two integer attributes: <tt class="docutils literal"><span class="pre">l</span></tt> and <tt class="docutils literal"><span class="pre">t</span></tt>. It is initialized by the constructor, updated by the <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt> method on the mover, and used later on to add to the mouse coordinates before passing them to host&#8217;s <tt class="docutils literal"><span class="pre">onMove()</span></tt> as <tt class="docutils literal"><span class="pre">leftTop</span></tt>.</li>
</ul>
<p>Following public methods are defined:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">destroy()</span></tt> &#8212; should be call, when you want to stop the move.</li>
<li><tt class="docutils literal"><span class="pre">onFirstMove()</span></tt> &#8212; called once to finish setting up the <tt class="docutils literal"><span class="pre">marginBox</span></tt> property. Additionally it calls the host&#8217;s <tt class="docutils literal"><span class="pre">onFirstMove()</span></tt>.</li>
</ul>
</div>
<div class="section" id="id22">
<h4>Event processors<a class="headerlink" href="#id22" title="Permalink to this headline">¶</a></h4>
<p>Following mouse event handlers are set up: <tt class="docutils literal"><span class="pre">onMouseMove</span></tt>, <tt class="docutils literal"><span class="pre">onMouseUp</span></tt>. Additionally <tt class="docutils literal"><span class="pre">ondragselect</span></tt> and <tt class="docutils literal"><span class="pre">onselectstart</span></tt> events are canceled.</p>
</div>
</div>
<div class="section" id="specialized-moveables">
<h3>Specialized Moveables<a class="headerlink" href="#specialized-moveables" title="Permalink to this headline">¶</a></h3>
<p>Following specialized moveable classes are defined:</p>
<div class="section" id="constrainedmoveable">
<h4>constrainedMoveable<a class="headerlink" href="#constrainedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo.dnd.move.constrainedMoveable</span></tt> can be used to constrained a move to a dynamically calculated box. This class is define in the <tt class="docutils literal"><span class="pre">dojo.dnd.move</span></tt> module. It is based on <a class="reference" href="#moveable">Moveable</a>, and accepts following additional parameters during construction:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">constraints</span></tt> &#8212; a function, which is called in the context of this <a class="reference" href="#moveable">moveable</a>, with a newly created <a class="reference" href="#mover">mover</a> object, and returns a rectangle to be used for restrictions. The rectangle is an object, which defines following numeric attributes: <tt class="docutils literal"><span class="pre">l</span></tt> for left, <tt class="docutils literal"><span class="pre">t</span></tt> for top, <tt class="docutils literal"><span class="pre">w</span></tt> for width, and <tt class="docutils literal"><span class="pre">h</span></tt> for height. All numbers are in pixels.</li>
<li><tt class="docutils literal"><span class="pre">within</span></tt> &#8212; a Boolean flag. When it is <tt class="docutils literal"><span class="pre">true</span></tt>, the dragged node will be moved only within the defined rectangle, and cannot go outside of it. Otherwise, the restriction applies to the left-top corner of the moved node.</li>
</ul>
</div>
<div class="section" id="boxconstrainedmoveable">
<h4>boxConstrainedMoveable<a class="headerlink" href="#boxconstrainedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo.dnd.move.boxConstrainedMoveable</span></tt> can be used to constrain a move to a predefined box. This class is define in the <tt class="docutils literal"><span class="pre">dojo.dnd.move</span></tt> module. It is based on <a class="reference" href="#constrainedmoveable">constrainedMoveable</a> and accepts following additional parameters during construction:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">box</span></tt> &#8212; a rectangle box (see <a class="reference" href="#constrainedmoveable">constrainedMoveable</a>), which defines constraint boundaries.</li>
<li><tt class="docutils literal"><span class="pre">within</span></tt> &#8212; see <a class="reference" href="#constrainedmoveable">constrainedMoveable</a> for details.</li>
</ul>
</div>
<div class="section" id="parentconstrainedmoveable">
<h4>parentConstrainedMoveable<a class="headerlink" href="#parentconstrainedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo.dnd.move.parentConstrainedMoveable</span></tt> can be used to constrain the move by the boundaries of the node&#8217;s parent. This class is define in the <tt class="docutils literal"><span class="pre">dojo.dnd.move</span></tt> module. It is based on <a class="reference" href="#constrainedmoveable">constrainedMoveable</a> and accepts following additional parameters during construction:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">area</span></tt> &#8212; a string, which defines constraint boundaries. Valid values are: <tt class="docutils literal"><span class="pre">&quot;content&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;padding&quot;</span></tt>, <tt class="docutils literal"><span class="pre">&quot;border&quot;</span></tt>, and <tt class="docutils literal"><span class="pre">&quot;margin&quot;</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">within</span></tt> &#8212; see <a class="reference" href="#constrainedmoveable">constrainedMoveable</a> for details.</li>
</ul>
</div>
<div class="section" id="timedmoveable">
<h4>TimedMoveable<a class="headerlink" href="#timedmoveable" title="Permalink to this headline">¶</a></h4>
<p><tt class="docutils literal"><span class="pre">dojo.dnd.TimedMoveable</span></tt> can be used to throttle FPS while moving nodes. This class is defined in its own module. It is based on <a class="reference" href="#moveable">Moveable</a>, and accepts following additional parameters during construction:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">timeout</span></tt> &#8212; the time delay number in milliseconds. The node will not be moved for that number of milliseconds, but it will continue to accumulate changes in the mouse position.</li>
</ul>
</div>
</div>
</div>
<div class="section" id="subclassing-dnd-classes">
<h2><a class="toc-backref" href="#id29">Subclassing DnD classes<a class="headerlink" href="#subclassing-dnd-classes" title="Permalink to this headline">¶</a></a></h2>
<p>If you want to subclass <a class="reference" href="#container">Container</a>, <a class="reference" href="#selector">Selector</a>, <a class="reference" href="#source">Source</a>, <a class="reference" href="#moveable">Moveable</a>, or their descendants, and you want to use the declarative markup, don&#8217;t forget to implement the <tt class="docutils literal"><span class="pre">markupFactory()</span></tt> method. The reason for that is <tt class="docutils literal"><span class="pre">dojo.parser</span></tt>, which instantiates the markup, expects a very particular signature from a constructor. Dojo DnD classes predate <tt class="docutils literal"><span class="pre">dojo.parser</span></tt>, and have a non-conformant signature. <tt class="docutils literal"><span class="pre">dojo.parser</span></tt> is smart enough to use a special adapter function in such cases. See the source code for <tt class="docutils literal"><span class="pre">dojo.dnd.Source.markupFactory()</span></tt> (for the <a class="reference" href="#container">Container</a>-<a class="reference" href="#selector">Selector</a>-<a class="reference" href="#source">Source</a> chain), and <tt class="docutils literal"><span class="pre">dojo.dnd.Moveable.markupFactory()</span></tt> for details. The key point is to return the instance of your new class there. Otherwise the instance of your base class is going to be created, which is probably not what you want.</p>
</div>
<div class="section" id="summary-of-css-classes">
<h2><a class="toc-backref" href="#id30">Summary of CSS classes<a class="headerlink" href="#summary-of-css-classes" title="Permalink to this headline">¶</a></a></h2>
<p>All DnD-related classes can affect 6 types of DOM nodes. All of them are collected in this section for your convenience. Using CSS classes described here you can design extremely sophisticated UI to improve usability and enhance the workflow of your applications.</p>
<div class="section" id="body">
<h3>body<a class="headerlink" href="#body" title="Permalink to this headline">¶</a></h3>
<p>The <tt class="docutils literal"><span class="pre">body</span></tt> node is updated only during active DnD operations. It can be used during the move to deemphasize temporarily the web page and to highlight available targets or a moved object.</p>
<p>Following CSS classes are used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndCopy</span></tt> &#8212; assigned to the <tt class="docutils literal"><span class="pre">body</span></tt> during the copy DnD operations (<em>dojo.dnd</em>).</li>
<li><tt class="docutils literal"><span class="pre">dojoDndMove</span></tt> &#8212; assigned to the <tt class="docutils literal"><span class="pre">body</span></tt> during the move DnD operations (<em>dojo.dnd</em>).</li>
<li><tt class="docutils literal"><span class="pre">dojoMove</span></tt> &#8212; assigned to the <tt class="docutils literal"><span class="pre">body</span></tt> when the drag is in progress (<em>dojo.dnd.move</em>).</li>
</ul>
</div>
<div class="section" id="source-target-dojo-dnd">
<h3>Source/target (dojo.dnd)<a class="headerlink" href="#source-target-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>Source can be assigned several classes to reflect its current role. These classes can be used together with the body CSS classes described above to create CSS rules to differentiate containers visually during DnD.</p>
<p>Following CSS classes are used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndContainer</span></tt> &#8212; assigned to each container node during the construction.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndContainerOver</span></tt> &#8212; assigned when the mouse hovers over the container.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndHorizontal</span></tt> &#8212; assigned to the container node during the construction, if this object represents a horizontal list of dndItems &#8212; its <tt class="docutils literal"><span class="pre">horizontal</span></tt> property set to <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> &#8212; assigned to the container node during the construction, if this object can be used as a source of DnD items &#8212; its <tt class="docutils literal"><span class="pre">isSource</span></tt> property set to <tt class="docutils literal"><span class="pre">true</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndSourceCopied</span></tt> &#8212; assigned to the container node during the active DnD operation when user copies items from it, e.g., pressed the Ctrl key while dragging. When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndSourceMoved</span></tt> &#8212; assigned to the container node during the active DnD operation when user moves items from it, e.g., the Ctrl key is not pressed while dragging. When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndSource</span></tt> class is removed.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt> &#8212; assigned to the container node during the construction, if this object can potentially accept DnD items &#8212; its <tt class="docutils literal"><span class="pre">accept</span></tt> array is not empty.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndTargetDisabled</span></tt> &#8212; assigned to the container node during the active DnD operation when this node cannot accept currently dragged items, e.g., because it doesn&#8217;t accept items of these types. When this class is assigned to the node, <tt class="docutils literal"><span class="pre">dojoDndTarget</span></tt> class is removed.</li>
</ul>
</div>
<div class="section" id="dnd-item-dojo-dnd">
<h3>DnD item (dojo.dnd)<a class="headerlink" href="#dnd-item-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>DnD items can be assigned several classes to reflect their current role visually.</p>
<p>Following CSS classes are used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> &#8212; assigned to every new data item node. It should be assigned to every item before the container construction, if you want it to be added automatically by the constructor or <tt class="docutils literal"><span class="pre">sync()</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemOver</span></tt> &#8211; assigned to a data item node when the mouse hovers over the this item. This class is assigned in addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemSelected</span></tt> &#8212; assigned if a data item is selected but it is not an anchor (the last selected element). This class is assigned in addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemAnchor</span></tt> &#8212; assigned to an anchor data item. At any given time the selector can have zero or one anchor. This class is assigned in addition to <tt class="docutils literal"><span class="pre">dojoDndItem</span></tt> class. Being an anchor means that this item is selected.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemBefore</span></tt> &#8212; assigned to the data item node during the active DnD operation if transferred items will be inserted before this item. This class is assigned in addition to all other classes.</li>
<li><tt class="docutils literal"><span class="pre">dojoDndItemAfter</span></tt> &#8212; assigned to the data item node during the active DnD operation if transferred items will be inserted after this item. This class is assigned in addition to all other classes.</li>
</ul>
</div>
<div class="section" id="dnd-handles-dojo-dnd">
<h3>DnD handles (dojo.dnd)<a class="headerlink" href="#dnd-handles-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>DnD items can defined special handles on their descendants, which can be used for dragging. In this case the body of the DnD item cannot be used to start the drag.</p>
<p>Following CSS classes are used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndHandle</span></tt> &#8212; assigned to handles of item nodes. See the <tt class="docutils literal"><span class="pre">withHandles</span></tt> parameter of <a class="reference" href="#source">Source</a>.</li>
</ul>
</div>
<div class="section" id="avatar-dojo-dnd">
<h3>Avatar (dojo.dnd)<a class="headerlink" href="#avatar-dojo-dnd" title="Permalink to this headline">¶</a></h3>
<p>The default avatar can be styled to suit your needs.</p>
<p>Following CSS classes are used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoDndAvatar</span></tt> &#8212; assigned to the avatar node (the table).</li>
<li><tt class="docutils literal"><span class="pre">dojoDndAvatarHeader</span></tt> &#8212; assigned to the first row/the header (the first <tt class="docutils literal"><span class="pre">tr</span></tt> node).</li>
<li><tt class="docutils literal"><span class="pre">dojoDndAvatarItem</span></tt> &#8212; assigned to the avatar item rows (<tt class="docutils literal"><span class="pre">tr</span></tt> nodes excluding the very first one).</li>
<li><tt class="docutils literal"><span class="pre">dojoDndAvatarCanDrop</span></tt> &#8212; added to the avatar node (the table) when the mouse is over a target, which can accept transferred items. Otherwise it is removed.</li>
</ul>
</div>
<div class="section" id="dragged-node-dojo-dnd-move">
<h3>Dragged node (dojo.dnd.move)<a class="headerlink" href="#dragged-node-dojo-dnd-move" title="Permalink to this headline">¶</a></h3>
<p>The dragged node can be specially styled while in move.</p>
<p>Following CSS classes are used:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">dojoMoveItem</span></tt> &#8212; assigned to the dragged node when the move is in progress.</li>
</ul>
</div>
</div>
<div class="section" id="summary-of-topics">
<h2><a class="toc-backref" href="#id31">Summary of topics<a class="headerlink" href="#summary-of-topics" title="Permalink to this headline">¶</a></a></h2>
<p>While local events are the preferred way to handle state changes, in some cases topics (named global events) can be used. <strong>Please double-check if you have to use topics instead of events.</strong></p>
<p>Following topic events can be generated by <a class="reference" href="#manager">Manager</a>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">/dnd/start</span></tt> &#8212; when DnD starts. Current <tt class="docutils literal"><span class="pre">source</span></tt>, <tt class="docutils literal"><span class="pre">nodes</span></tt>, and <tt class="docutils literal"><span class="pre">copy</span></tt> flag (see <a class="reference" href="#manager">Manager</a>&#8216;s <tt class="docutils literal"><span class="pre">startDrag()</span></tt> for more info) are passed as parameters of this event.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/source/over</span></tt> &#8212; when the mouse moves over a source. The source in question is passed as a parameter. The same event is raised when the mouse goes out of a source. In this case <tt class="docutils literal"><span class="pre">null</span></tt> is passed as a parameter.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/drop/before</span></tt> &#8212; raised just before the drop. It can be used to capture the drop parameters. Parameters are the same as for <tt class="docutils literal"><span class="pre">/dnd/drop</span></tt>.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/drop</span></tt> &#8212; raised to perform a drop. The first three parameters are the same as for <tt class="docutils literal"><span class="pre">/dnd/start</span></tt>. The fourth parameter is the target object. Note that during the processing of this event nodes can be already moved, or reused. If you need the original nodes, use <tt class="docutils literal"><span class="pre">/dnd/drop/before</span></tt> to capture them, or use events local to source/target objects.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/cancel</span></tt> &#8212; when DnD was cancelled either by user (by hitting Esc), or by dropping items in illegal location. This topic has no parameters.</li>
</ul>
<p>All sources subscribe to <a class="reference" href="#manager">Manager</a>&#8216;s topics. Some users fail to understand that if they override, say, <tt class="docutils literal"><span class="pre">onDndDrop()</span></tt> method, which is a <tt class="docutils literal"><span class="pre">/dnd/drop</span></tt> topic listener, it will be called <strong>every time</strong> <tt class="docutils literal"><span class="pre">/dnd/drop</span></tt> is signaled. It means it will be notified even if your source was not the part of the DnD exchange &#8212; it wasn&#8217;t a source of the items, and it is not a target of the drop. If you subclass <a class="reference" href="#source">Source</a> and override <tt class="docutils literal"><span class="pre">onDndDrop()</span></tt>, your new method will be called for every instance of your class.</p>
<p>Following topic events are raised by <a class="reference" href="#moveable">Moveable</a>:</p>
<ul class="simple">
<li><tt class="docutils literal"><span class="pre">/dnd/move/start</span></tt> &#8212; published by the default implementation of <a class="reference" href="#moveable">Moveable</a>&#8216;s <tt class="docutils literal"><span class="pre">onMoveStart()</span></tt> passing a <a class="reference" href="#mover">mover</a> as parameter.</li>
<li><tt class="docutils literal"><span class="pre">/dnd/move/stop</span></tt> &#8212; published by the default implementation of <a class="reference" href="#moveable">Moveable</a>&#8216;s <tt class="docutils literal"><span class="pre">onMoveStop()</span></tt> passing a mover as parameter.</li>
</ul>
</div>
<div class="section" id="available-tests">
<h2><a class="toc-backref" href="#id32">Available tests<a class="headerlink" href="#available-tests" title="Permalink to this headline">¶</a></a></h2>
<p>All tests are located in the <tt class="docutils literal"><span class="pre">dojo/tests/dnd/</span></tt> sub-directory. They are used by developers to test the conformance, and can be used by users to see how different objects and algorithms can be used. Following tests are available (these are external links to Dojo Nightlies, which are are not set up for speed but for debugging):</p>
<ul class="simple">
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_dnd.html">test_dnd.html</a> tests general DnD operations including the markup and programmatic creation, pure targets, a special representation of DnD items in the avatar, styling of different objects, complex selection of items, and topics.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_container.html">test_container.html</a> tests the default creator function with different types of containers created programmatically.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_container_markup.html">test_container_markup.html</a> tests the default creator function with different types of containers created with the markup.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_selector.html">test_selector.html</a> tests the default creator function with different types of containers created programmatically.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_selector_markup.html">test_selector_markup.html</a> tests the default creator function with different types of containers created with the markup.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_dnd_handles.html">test_dnd_handles.html</a> tests DnD handles. All objects are created with the markup.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_form.html">test_form.html</a> tests skipping form elements.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_moveable.html">test_moveable.html</a> tests moveable nodes declared moveable programmatically. Additionally it tests topics.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_moveable_markup.html">test_moveable_markup.html</a> tests moveable nodes declared moveable by the markup. Additionally it tests topics.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_params.html">test_params.html</a> tests delay and skip parameters.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_box_constraints.html">test_box_constraints.html</a> tests dojo.dnd.move.boxConstrainedMoveable using programmatic and markup methods.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_parent_constraints.html">test_parent_constraints.html</a> tests dojo.dnd.move.parentConstrainedMoveable with all &#8220;area&#8221; values.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_parent_constraints_margins.html">test_parent_constraints_margins.html</a> tests dojo.dnd.move.parentConstrainedMoveable with all &#8220;within&#8221; values.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_custom_constraints.html">test_custom_constraints.html</a> tests dojo.dnd.move.constrainedMoveable implementing the &#8220;grid move&#8221; pattern.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/test_timed_moveable.html">test_timed_moveable.html</a> tests dojo.dnd.TimedMoveable with different timeout values.</li>
<li><a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/flickr_viewer.html">flickr_viewer.html</a> implements an elaborate demo, which retrieves pictures of three types from Flickr, and allows to sort them into two bins according to their types. It demonstrates many techniques including horizontal vs. vertical containers, different representation of data items in different containers and in the avatar, and so on.</li>
</ul>
<p>The same directory contains a simple CSS file, which shows how you can style the DnD objects: <a class="reference" href="http://archive.dojotoolkit.org/nightly/dojotoolkit/dojo/tests/dnd/dndDefault.css">dndDefault.css</a>. You can see it in action in almost all tests. It can be used as a starting point for your own styling.</p>
</div>
<div class="section" id="external-tutorials-and-documentation">
<h2><a class="toc-backref" href="#id33">External tutorials and documentation<a class="headerlink" href="#external-tutorials-and-documentation" title="Permalink to this headline">¶</a></a></h2>
<dl class="docutils">
<dt><a class="reference" href="http://www.sitepen.com/blog/2008/06/10/dojo-drag-and-drop-1/">Dojo Drag and Drop, Part 1: dojo.dnd</a> by Revin Guillen at <a class="reference" href="http://www.sitepen.com/">SitePen</a>.</dt>
<dd>The comprehensive explanation of dojo.dnd, and how to leverage it in real applications. The author build the &#8220;shopping cart&#8221; in several iterations commenting code snippets and providing full source code for all examples. The only drawback is: this article uses topic handlers, because it was published before the introduction of local events.</dd>
<dt><a class="reference" href="http://www.sitepen.com/blog/2008/10/24/inside-dojo-dnd-drag-handles/">Inside Dojo DnD: Drag Handles</a> by <a class="reference" href="http://lazutkin.com/">Eugene Lazutkin</a> at <a class="reference" href="http://www.sitepen.com/">SitePen</a>.</dt>
<dd>The article explains a frequently overlooked and underused feature of Dojo’s Drag-and-Drop (DnD) module: drag handles. It features several simple examples and clarifies some fine points.</dd>
<dt><a class="reference" href="http://docs.google.com/Edit?tab=view&amp;docid=d764479_20ghbr97c8">dojo.dnd 1.1 technical documentation</a> by <a class="reference" href="http://lazutkin.com/">Eugene Lazutkin</a></dt>
<dd>This is the technical documentation for Dojo DnD 1.1 listed here only as a historic reference. This document is based on it.</dd>
</dl>
</div>
<div class="section" id="tips">
<h2><a class="toc-backref" href="#id34">Tips<a class="headerlink" href="#tips" title="Permalink to this headline">¶</a></a></h2>
<p>In order to limit the maximum number of items in a DnD source, you can override the checkAcceptance() method on your source, and return <tt class="docutils literal"><span class="pre">false</span></tt>, when you reached your limit.</p>
<p>The DnD itself uses <tt class="docutils literal"><span class="pre">onmousedown</span></tt>/<tt class="docutils literal"><span class="pre">onmousemove</span></tt>/<tt class="docutils literal"><span class="pre">onmouseup</span></tt> to operate. If you want to process <tt class="docutils literal"><span class="pre">onclick</span></tt>, be warned that this is the synthetic event: essentially it is <tt class="docutils literal"><span class="pre">onmousedown</span> <span class="pre">+</span> <span class="pre">onmouseup</span></tt>, which occurred within some predefined time interval (usually settable on the OS level), or using other criteria. Some browsers generate <tt class="docutils literal"><span class="pre">onclick</span></tt> on every <tt class="docutils literal"><span class="pre">onmouseup</span></tt>. Working with DnD you will get plenty of false <tt class="docutils literal"><span class="pre">onclick</span></tt> events. Some of them happen naturally, when user decided to drag but changed her mind clicking the mouse button generating <tt class="docutils literal"><span class="pre">onclick</span></tt>. <em>Be extra careful when processing</em> <tt class="docutils literal"><span class="pre">onclick</span></tt> <em>on DnD sources!</em></p>
</div>
</div>


		      </div>
		    </div>
		  </div>
		  <div class="clearfix"></div>
	</div>
      </div>
	</div>
      <div class="clearer"></div>
    </div>
<div id="footer">
    
    <div class="footer">
      &copy; Copyright 2009, Dojo Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>
</div>
<script type="text/javascript">
	document.body.className = "nihilo";
</script>
<script type="text/javascript">
    dojo.require("docs.widget.CodeViewer");
    dojo.require("docs.widget.CompoundViewer");
</script>
<!--
    <div class="footer">
      &copy; Copyright 2009, Dojo Foundation.
      Created using <a href="http://sphinx.pocoo.org/">Sphinx</a> 0.6.1.
    </div>-->

  </body>
</html>